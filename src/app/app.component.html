<div class="sfm">
  <div
    class="sfm-left"
    style.backgroundImage="url({{ (current$ | async)?.track?.album?.images[0].url }})">

    <div class="sfm-nav">
      <div class="grid-padding pt-3 pb-3">
        <div class="container-fluid">
          <div class="row">
            <div class="col-12">
              <img class="img-logo" src="/assets/img/logo/logo-white.svg" alt="SOON FM_">
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="sfm-playlist">

      <div class="sfm-playlist-heading">
        <div class="sfm-playlist-heading-content">
          <p class="text-primary font-weight-bold rotate-90 text-nowrap sfm-playlist-heading-text mb-0">
            Upcoming beats
          </p>
        </div>
      </div>

      <div class="sfm-playlist-tracks">

        <div class="grid-padding">
          <div class="container-fluid">
            <div class="row">
              <div class="col-12">

                <ul class="list-unstyled">
                  <ng-template ngFor let-item [ngForOf]="queue$ | async">
                    <li>
                      <div class="media media-hover align-items-center mb-3">
                        <div
                          class="media-img d-flex mr-3"
                          style.backgroundImage="url({{ item.track.album.images[0].url }})">
                          <img
                            [src]="item.track.album.images[0].url"
                            [alt]="item.track.name">
                        </div>
                        <div class="media-body">
                          <h3 class="h1 mt-0 mb-0 text-truncate">
                            {{ item.track.name }}
                          </h3>
                          <p class="lead mb-0 font-weight-bold text-truncate">
                            {{ item.track.artistsAsString }}
                          </p>
                          <p class="lead mb-0 font-weight-bold text-muted text-truncate">
                            {{ item.track.album.name }}
                          </p>
                        </div>
                        <div class="media-user d-flex align-items-center ml-3 flex-column">
                          <p class="small">Added by</p>
                          <img
                            class="rounded-circle img-avatar"
                            [src]="item.user.avatar_url"
                            [alt]="item.user.display_name">
                        </div>
                      </div>
                    </li>
                  </ng-template>
                </ul>

              </div>
            </div>
          </div>
        </div>

      </div>

    </div>

  </div>

  <div class="sfm-right" *ngIf="isStatsView">

    <div class="sfm-nav">
      <div class="grid-padding pt-3 pb-3">

        <div class="container-fluid">
          <div class="row">
            <div class="col-12">

                <ul class="list-inline text-right mb-0">
                  <li class="list-inline-item pr-3">
                    <a
                      class="text-white h4"
                      href="#"
                      role="button"
                      (click)="$event.preventDefault();view = 2">
                      <i class="icon icon-stats-dots"></i>
                    </a>
                  </li>
                  <li class="list-inline-item pr-3">
                    <a
                      class="text-white h4"
                      href="#"
                      role="button"
                      (click)="$event.preventDefault();view = 1">
                      <i class="icon icon-history"></i>
                    </a>
                  </li>
                  <li class="list-inline-item">
                    <a
                      class="text-white h4"
                      href="#"
                      role="button"
                      (click)="$event.preventDefault();view = 0">
                      <i class="icon icon-search"></i>
                    </a>
                  </li>
                </ul>

            </div>
          </div>
        </div>

      </div>
    </div>

    <div class="sfm-info pt-2">
      <div class="row no-gutters pl-3 sfm-stats">

        <div class="col-12 mb-4">
          <h2 class="h6 font-weight-bold text-primary mb-2">Weekly Leaderboard</h2>

          <div class="leaderboard text-center">
            <ul class="list-inline">
              <li class="list-inline-item mr-4">
                <img class="rounded-circle img-avatar mb-1" src="//via.placeholder.com/300x300" alt="">
                <p class="mb-1 font-weight-bold">Caroline</p>
                <p class="small font-weight-bold">
                  <span class="text-primary">1st</span>
                  <span class="text-muted">(168 Plays)</span>
                </p>
              </li>
              <li class="list-inline-item mr-4">
                <img class="rounded-circle img-avatar mb-1" src="//via.placeholder.com/300x300" alt="">
                <p class="mb-1 font-weight-bold">Inga</p>
                <p class="small font-weight-bold">
                  <span class="text-primary">2nd</span>
                  <span class="text-muted">(168 Plays)</span>
                </p>
              </li>
              <li class="list-inline-item">
                <img class="rounded-circle img-avatar mb-1" src="//via.placeholder.com/300x300" alt="">
                <p class="mb-1 font-weight-bold">Emma</p>
                <p class="small font-weight-bold">
                  <span class="text-primary">3rd</span>
                  <span class="text-muted">(168 Plays)</span>
                </p>
              </li>
            </ul>

            <a href="#" class="font-weight-bold pt-0 pb-0">View more</a>

          </div>
        </div>

      </div>

      <div class="row no-gutters pl-3 pb-3 sfm-controls">
        <div class="col-12">

          <div *ngIf="(current$ | async)?.track">
            <div class="row no-gutters">
              <div class="col-6">
                <p class="font-weight-bold text-primary mb-0">Playing now</p>
              </div>
              <div class="col-6">
                <p class="font-weight-bold text-muted text-right mb-0 pr-3">{{ (meta$ | async)?.play_time | date:'m:ss' }} of playing time</p>
              </div>
              <div class="col-12">
                <hr>
              </div>
            </div>

            <div class="row no-gutters mb-2 pr-3">
              <div class="col-12">
                <div class="media align-items-center">
                  <div class="media-body">
                    <h3 class="h1 mt-0 mb-0 text-truncate">
                      {{ (current$ | async)?.track?.name }}
                    </h3>
                    <p class="lead mb-0 font-weight-bold text-truncate">
                      {{ (current$ | async)?.track?.artistsAsString }}
                    </p>
                    <p class="lead mb-0 font-weight-bold text-muted text-truncate">
                      {{ (current$ | async)?.track?.album?.name }}
                    </p>
                  </div>
                  <div class="media-user d-flex align-items-center ml-3 flex-column">
                    <p class="small">Added by</p>
                    <img
                      class="rounded-circle img-avatar"
                      [src]="(current$ | async)?.user?.avatar_url || ''"
                      [alt]="(current$ | async)?.user?.display_name">
                  </div>
                </div>
              </div>
            </div>

            <div class="row no-gutters mb-3">
              <div class="col-6">
                <!-- TODO: Equaliser -->
              </div>
              <div class="col-6 text-right pr-3">
                <p class="mb-0">{{ (current$ | async)?.player?.elapsed_time | date:'m:ss' }} / {{ (current$ | async)?.track?.duration | date:'m:ss' }}</p>
              </div>
            </div>

            <div class="row no-gutters align-items-center pr-3">
              <div class="col-6">
                <ul class="list-inline mb-0">
                  <li class="list-inline-item pr-2">
                    <button
                      type="button"
                      class="btn btn-icon btn-circle btn-outline-lighter"
                      [ngSwitch]="(current$ | async)?.paused"
                      (click)="togglePause()">
                      <i class="icon icon-play text-white" *ngSwitchCase="true"></i>
                      <i class="icon icon-pause text-white" *ngSwitchCase="false"></i>
                    </button>
                  </li>
                  <li class="list-inline-item pr-2">
                    <button
                      type="button"
                      class="btn btn-icon btn-circle btn-outline-lighter"
                      (click)="skip()">
                      <i class="icon icon-skip text-white"></i>
                    </button>
                  </li>
                  <li class="list-inline-item pr-2">
                    <button
                      type="button"
                      class="btn btn-icon btn-circle btn-outline-lighter"
                      [ngSwitch]="(mute$ | async)?.mute"
                      (click)="toggleMute()">
                      <i class="icon icon-volume-high text-white h5" *ngSwitchCase="false"></i>
                      <i class="icon icon-volume-mute text-white h5" *ngSwitchCase="true"></i>
                    </button>
                  </li>
                </ul>
              </div>
              <div class="col-6 text-right">
                <div class="volume-slider">
                  <div class="volume-slider-fill" style.width="{{ (volume$ | async)?.volume }}%"></div>
                  <input
                    class="volume-slider-input"
                    type="range"
                    min="0"
                    max="100"
                    step="1"
                    [value]="(volume$ | async)?.volume"
                    (input)="onVolumeInputChange($event)">
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>

  </div>

  <div class="sfm-right bg-white text-secondary" *ngIf="isSearchView">

    <div class="grid-padding">
      <div class="container-fluid pt-3 pb-3">
        <div class="row">
          <div class="col-12">

            <div class="d-flex justify-content-between">

              <div class="form-group border-left w-75">
                <input
                  type="text"
                  class="form-control"
                  placeholder="Start searching here…"
                  (input)="onSearchInputChange($event)">
              </div>

              <div class="dropdown">
                <button class="btn btn-link dropdown-toggle text-secondary" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  Tracks
                  <i class="icon icon-caret-down ml-1 small"></i>
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="dropdown-item" href="#">Tracks</a>
                  <a class="dropdown-item" href="#">Artists</a>
                  <a class="dropdown-item" href="#">Albums</a>
                </div>
              </div>

              <button class="btn btn-link text-secondary" (click)="view = 2">
                <i class="icon icon-close"></i>
              </button>

            </div>


          </div>
        </div>
      </div>
    </div>

    <div class="pt-3 pb-3 bg-white text-secondary" *ngFor="let item of (search$ | async)?.results">
      <div class="row no-gutters">
        <div class="col-12">
          <div class="media align-items-center">
            <div class="media-img media-img-lg d-flex mr-3" style.backgroundImage="url({{ item.album.images[1].url }})">
              <img [src]="item.album.images[1].url" [alt]="item.name">
            </div>
            <div class="media-body align-items-center">
              <h3 class="h5 mt-0 mb-1 text-truncate">{{ item.name }}</h3>
              <p class="lead mb-0 text-light text-truncate">{{ item.artists[0].name }}</p>
              <p class="lead mb-2 text-light text-truncate">{{ item.album.name }}</p>
              <p class="mb-0">{{ item.duration_ms | date:'m:ss' }}  <!-- <span class="seperator"></span> Rap--></p>
            </div>
            <div class="media-cta d-flex align-self-start align-items-start ml-3 flex-column">
              <button
                type="button"
                class="btn btn-primary text-secondary rotate-90"
                (click)="addToQueue(item.uri)">
                <i class="icon icon-plus pr-2"></i>
                <span class="small font-weight-bold">Add to playlist</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>

</div>
